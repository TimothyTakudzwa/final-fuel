{% extends "supplier/dashboard.html" %}
{% load static %}
{% block title %}
{{title}}
{% endblock %}
{% block body %}
<script>
    $(document).ready(function () {
        var socket = io.connect('http://159.65.66.59:5000/new_offer');
        console.log("Got to this part ")
        console.log(socket)
        socket.on('new_offer', function (msg) {
            $('.new_alert').hide()
            var txt1 = " <h4 class='alert-heading'>New Request</h4><hr>" + msg.notification +  "<hr><small>Click to View </small></hr>";   
            $("#new_message").empty(txt1);   
            $("#new_message").append(txt1);  
            $('.new_alert').show()


        });
    });
</script>

<div  style="display:none" class=" new_alert alert alert-success alert-dismissible fade show" role="alert">
    
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
  <strong><i data-notify="icon" class="material-icons">add_alert</i><span
    data-notify="title"></span> <div id='new_message' ></div><a href="#" target="_blank" data-notify="url"></a></strong> 
</div>

<!-- <div data-notify="container" style="display: none;" class="col-11 col-md-4 alert alert-info alert-with-icon animated fadeInDown" role="alert"
    data-notify-position="top-center"
    style="display: inline-block; margin: 15px auto; position: fixed; transition: all 0.5s ease-in-out 0s; z-index: 1031; top: 20px; left: 0px; right: 0px;">
    <button type="button" aria-hidden="true" class="close" data-notify="dismiss"
        style="position: absolute; right: 10px; top: 50%; margin-top: -9px; z-index: 1033;"><i
            class="material-icons">close</i></button><i data-notify="icon" class="material-icons">add_alert</i><span
        data-notify="title"></span> <span data-notify="message">Welcome to <b>Material Dashboard Pro</b> - a beautiful
        admin panel for every web developer.</span><a href="#" target="_blank" data-notify="url"></a></div> -->
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-3">Offers</h1>
            <p class="lead">

                {% if user.activated_for_whatsapp == True %}
                <a class="btn btn-outline-danger" href="{% url 'activate_whatsapp' %}">Deactivate Whatsapp</a>
                {% else %}
                <a class="btn btn-outline-primary" href="{% url 'activate_whatsapp' %}">Activate Whatsapp</a>
                {% endif %}

            </p>

        </div>
    </div>
    <div class="col-md-12">
        <div class="card mt-5" style="background-color:white">
            <div class="card-header card-header-primary">
                <h4 class="card-title">Offers</h4>
                <p class="card-category"> List Of All Offers</p>
            </div>
            <div class="card-body">
                <div class="container-fluid">
                    <table id="example" class="table table-striped table-bordered" style="width:100%">
                        <thead style="background-color: lightslategray; color:white;">
                            <tr>
                                <th style="color: white;"></th>
                                <th style="color: white;">Date</th>
                                <th style="color: white;">Buyer</th>
                                <th style="color: white;">Requested(l)</th>
                                <th style="color: white;">Offered(l)</th>
                                <th style="color: white;">Fuel</th>
                                <th style="color: white;">Payment</th>
                                <th style="color: white;">Delivery</th>
                                <th style="color: white;">Address</th>
                                <th style="color: white;">Equipments</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for offer in offers %}
                            <tr>
                                <td></td>
                                <td>{{ offer.date }}</td>
                                <td>{{ offer.request.name }}</td>
                                <td>{{ offer.request.amount }}</td>
                                <td>{{ offer.quantity }}</td>
                                <td>{{ offer.request.fuel_type }}</td>
                                <td>{% if offer.cash %}CASH &nbsp;{%endif%} {% if offer.ecocash %}ECOCASH &nbsp;{%endif%} {% if offer.usd %}USD &nbsp; {%endif%} {% if offer.swipe %}SWIPE{% endif %}</td>
                                <td>{{ offer.delivery_method }}</td>
                                <td>{{ offer.collection_address }}</td>
                                <td>{% if offer.pump_available %}Pump &nbsp;{% if offer.dipping_stick_available %}Stick &nbsp;{% if offer.meter_available %}Meter{% endif %}{% endif %}{% endif %}</td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{%endblock%}